### AST介绍

AST是Abstrct Syntax Tree的缩写，抽象语法树。

AST是解释器、编译器等程序对源代码进行语法分析后生成的一种树形结构，用于表示程序的抽象的语法结构。在AST中，每个节点代表源代码中的一个语法结构，如表达式、函数、语句等，节点之间通过父子关系连接起来，形成一棵树。

AST通常是解释器、编译器等程序在进行语法分析后生成的一种中间表示形式，可以被用于进一步的代码优化、检查、生成等操作。在编程语言工具中，AST也经常被用于语法高亮、自动补全、重构等功能的实现。

### AST在编译器中的作用是什么？

在编译器中，AST是非常重要的中间表现形式之一，它的作用主要可以从以下几个方面进行分析:

1. 语法分析：编译器首先需要对源代码进行语法分析，将其转换为一棵抽象的语法树，以便更好的理解代码的语法结构；

2. 语义分析：AST中的节点不仅仅表示语法结构，还包含了很多的语义信息，如类型、变量、函数等。编译器可以利用这些信息进行语义分析，检查代码是否符合语义规范；

3. 代码优化：编译器可以通过分析AST中的语法结构，发现其中的优化机会，比如常量折叠、无用代码消除等优化，从而生成更高效的目标代码；

4. 目标代码生成：AST可以被用于生成目标代码，编译器可以将AST转换为中间表示形式，再根据目标机器的特性生成相应的机器码；

5. 错误处理：当编译器发现源代码中存在语法错误时，它可以在语法分析阶段生成AST时进行错误检查，并将相关的错误信息记录在AST中，以便在后续的编译过程中进行处理。

### AST的表现形式是什么样子的？

在不同的领域AST可能有不同的表现形式，但是从根本上来说，AST的表现形式是一棵树，这棵树中会有节点类型、子节点、属性值。那么具体到前端的应用领域如React、Vue框架中，AST就是指其对应的虚拟DOM。

在React或者Vue中，在解析一个组件时，生成的AST通常被称为虚拟DOM，如下面的一个React组件：

```tsx
function Greeting(props:any){
    return (
        <div>Hello,{props.name}</div>
    )
}
```

这个UI组件，其对应的虚拟DOM也就是AST可表示为:

```js
{
    type: 'function',
    name: 'Greeting',
    props: {
        children:{
            type: 'jsx',
            value: '<div>Hello,{props.name}</div>'
        },
        props:{
            type: 'object',
            value: {
                name: {
                    type: 'string',
                    value: 'World'
                }
            }
        }
    }
}
```

乍听起来AST是一个很高端的概念，但是如果理解了这个概念之后，并和我们经常接触到的开发语言结合一下，就不会再感觉那么高大上了。

虚拟DOM是一个使用JS对象来表示真实DOM结构的树形结构，它代表了React组件的结构和状态，可以被用于实现React的高效更新机制。

当React组件被渲染时，React会将虚拟DOM转换为真实的DOM结构，并将其插入到文档中。当组件状态发生变化时，React会重新生成虚拟DOM，并与之前的虚拟DOM进行比较，找出变化的部分，然后只更新这些变化的部分，这种机制可以减少DOM的操作次数，提高页面的渲染效率。所以，我们可以将虚拟DOM视为AST的一种表现形式，它代表了React组件在页面中的结构和状态，可以被用于实现React的高效的更新机制。