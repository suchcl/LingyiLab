### 背景

* 现在项目在进行的过程中，业务越来越复杂，代码量越来越大，维护成本越来越高；
* 技术领域尤其是前端的技术细分领域，技术的迭代速度更是走在了各技术方向的前列，前端的技术规划和实施的要求也是越来越高
* 项目中有各种复杂的业务场景，按照之前的思路很难对已经存在的项目做全量的技术升级或者重构，风险高、成本高，一种理想的状态就是增量升级，既可以做技术的升级、重构，也能减小在技术升级、重构过程中对业务的影响；
* 多业务模块的运维部署，在一个大的项目中经常会有多个业务模块，经常伴随着不同的业务模块并行需求开发，但是不同时上线的情况。虽然我们可以选择单文件上线但是这无形中也增加了运维人员的上线成本，运维人员需要清楚的知道每次需求上线的文件列表；如果是认为的维护这些文件的话，容易出错；系统维护的话，需要有功能完善的运维系统，现实中能有几个公司有这个配置呢？
* 上文提到的大项目，项目的功能完善了，功能完善的同时风险也提高了：各业务线都在一个系统中，如果一个地方出现了问题，就会影响到整个系统的稳定性。从业务角度看，我不关心你技术的实现，但是有一个基本的诉求，技术的升级迭代，需要降低对业务的影响；谁也不想我每个月发的工资总是由于系统的原因给发错；

基于上文提到的一些场景，我们就有了一些实际的诉求，不管是技术侧的还是业务侧的，基本上底层的诉求是一致的：

1. 风险控制
   
技术方面的环节，可以做各种各样的技术探索和研究，业务方也需要，技术方也有诉求。技术的目标是提升业务价值，业务方也希望能有技术赋能；但是在技术探索和研究的过程中，需要做好风险控制，将风险降到最低，不能出现一个模块的问题影响到了其他业务模块的运行；

2. 技术的增量升级
上文已经提到，现在技术的发展速度很块，尤其是前端技术领域。前端的技术架构，既要保证代码的稳定性，又要保证技术跟上行业技术发展趋势。现在技术选型，基本上都是选择开源的技术框架，如果不跟上行业的发展节奏，以前的技术选型、框架都已经不再有社区维护。除非我们自己开发维护的开源框架，但又有几个公司有这样的精力呢？所以我们要时刻关注新的技术动态，跟上行业的节奏不掉队，又要降低对业务的影响；

3. 降低运维、测试成本

我们期望既可以有单文件上线的能力，也有整体上线的能力，在单文件上线的时候，有系统去筛选、识别需要上线的文件；在全量上线的时候，希望在部分业务需求上线时不影响其他的业务模块，也不需要每次的上线，都需要测试回归以前上过线的模块功能。

### 微前端

针对上面的一些问题和诉求，很多技术团毒都进行了各种各样的技术探索和尝试。

#### iframe

一些技术团队进行了各种探索，比较有代表性的就是iframe。但是经过实践证明，iframe并不是一个优秀的解决方案：

1. UI没有办法同步，DOM结构不能共享：iframe，其实就是将一个页面分成了几个部分，而每个部分的结构是相互隔离的。个别业务场景时需要有一个弹窗提示，在页面居中线上，那么这个时候通过iframe是很难实现的，但是我们也不能在当前的这个iframe模块居中显示，太不友好了。当然了，是可以通过postMessage机制来实现与父窗口的通信，让父窗口来为我们显示弹窗。这样在功能上是实现了，但是一个项目的业务场景实现，分散到了不同的项目去实现，维护成本及其高，这种解决方案很可能没有解决我们上面诉求、问题，还可能给我们带来了代码维护成本的提升，问题会变的更加尖锐；

2. 环境隔离，各个子应用之间的通信、数据同步等问题，实现成本都急剧上升，也带来了同样的一个结果，就是维护成本的急剧上升；

3. 性能的下降，使用体验的下降。每个子应用的加载，都是一次浏览器资源重新加载、渲染的过程，性能上和使用体感上都会明显下降；

4. url不能同步：浏览器刷新，每个子应用的iframe的url都会被重置，都会回到最原始状态，浏览器没有办法记录每个子应用的各自的状态；

#### 工作台模式

这种解决方案，核心的功能还是拆项目，将项目拆分，然后将所有的项目的入口集中到一个工作台，这个工作台提供了去往各个系统的入口。项目拆分了，然后加个单点登录，这样多项目之间就实现了登录状态的共享了，也可以算是一个不错的解决方案了。在没有其他解决方案的情况下，这可以说是相当优秀的一种解决方案了，各子项目之间相互独立，风险最低，通过单点登录还实现了各子项目之间的登录状态保持。

#### 微前端模式

微前端的理念是将前端项目拆分为一组可独立部署、松散耦合的应用，注意，是一组应用，不是一个应用。最终将这些应用组合在一起的面向用户的单个应用程序。微前端和上面提到的工作台模式之外，还有一点是工作台不具备的，是各个子项目之间除了登录状态通过单点登录来保持外，还可以实现其他的信息、数据的共享，实现成本简单。
