### AST

AST,抽象语法树.

**抽象语法树是什么?**

- 抽象语法树是源代码结构的一种抽象表示;

- 它以树状的结构表现编程语言的语法结构,树上的每个节点都表示源代码中的一种结构;

- 每个包含type属性的数据结构,都是一个AST节点;

以下是一个简单空函数的AST语法树:

```js
function test(){
	alert("Hello World!");
}
```

<img src="./images/i1.png" width="500" />

语法转换过程需要借助解析器来实现,常用的解析器有多种,具体可以参考: [ESLint解析器](../架构与设计/eslint解析器.md)

**抽象语法树有什么作用?有哪些用途?**

- 代码语法检查

- 代码风格检查

- 代码格式优化

- 代码显示高亮

- 代码错误提示

- 代码自动补全

- 代码的多端适配

- 自定义代码结构

- ……

webpack、eslint等工具的原理都是通过javascript解析器将代码转换为AST(抽象语法树),通过操作这棵树,实现代码的精准定位、语句赋值、语句运算等,实现对代码的分析、优化、变更等操作.

### javascript解析器

Javascript解析器,就是把javascript语法解析成AST语法树.

js很大的使用场景是在浏览器上,浏览器就是把js源码通过解析器转换成AST,然后再进一步转换为字节码或者直接生成机器码,最后进行渲染和执行.

一般来说,每个js引擎都会有自己的抽象语法树格式,常见的js引擎有Chrome的V8引擎、firefox的Spider Monkey、Safari的JSC(JavaScript Core)等等.

Javascript解析器通常包含4个部分:

- 词法解析器(Lexical Analyser)

- 语法解析器(Syntax Parser)

- 字节码生成器(Bytecode generator)

- 字节码解释器(Bytecode interpreter)

#### 词法解析器

词法分析器首先扫描代码,通过switch case把源码转换为一个个的小语法单元.JS代码的语法单元大体上有以下这些:

- 空白:js中连续的空格、换行、缩进等这些如果不在一个字符串里面,则它们就没有实际的逻辑意义,于是就把这些连续的空白符直接组合在一起作为一个整体的语法单元

- 注释:块注释、行注释、文件注释还是函数注释,虽然它们对阅读代码的人来说有很重要的意义,但是它们对于计算机来说并没有任何价值,计算机只需要知道它们是个注释、不影响逻辑的一个部分就行了,所以也将注释作为一个不可拆分的语法单元

- 字符串:对于机器而言,字符串就是用于展示或参与计算的内容,它们已经是最小的词法单元了,没有再继续拆分分析的必要了,就作为一个语法单元;

- 数字:js这门语言里有二进制、八进制、十进制、十六进制、科学计数法等表示方法,数字是一个可以表示完整意义的最小语法单元

- 标识符:没有被引号引起来的连续字符串,可包含字母、数字、_、$等(开头不能是数字),标识符可能是一个变量,也可能是如boolean类型的true、false,也可能是语言系统本身预留的一些关键字、保留字,但是在词法分析阶段并不关心这些,关心的是能把这个标识符和别的字符串、标识符区分开即可

- 运算符:+、-、*、/、>、<等

- 括号:主要用来标识运算的优先级、函数的调用.在分词阶段并不关心括号标识什么逻辑意义,仅仅把它当作一种基本的语法单元

#### 语法解析器

#### 字节码生成器

#### 字节码解释器

