## 迭代器 Iterator

迭代的意思就是重复、再来。在软件开发领域，就是按照顺序反复执行同一段代码的行为，一般情况下都会有明确的终止条件。ECMAScript6开始，新增了2个高级特性：迭代器和生成器。使用这2个特性，能够更清晰、方便、高效的实现迭代。

循环，是迭代机制的基础，这是因为循环可以指定迭代的次数，以及每次迭代需要执行什么样的操作。每次循环都是在下一次迭代之前弯沉，每次迭代的顺序都是提前预定好的。

由上面的介绍可以得知，迭代会在一个有序的集合上进行，有序，我们可以理解为集合中所有的项都可以按照既定的顺序被遍历到，特别是开始和结束都有明确的定义。数组是这类数据结构最典型的案例：

```javascript
let fruits = ["apple", "peach", "pear"];
for (let i = 0; i < fruits.length; i++) {
    console.log(fruits[i]);
}
```

由于部分的原因，通过这种方式的循环并不是理想的执行过程

1. 迭代之前需要先知道数据结构的相关知识，要知道数据结构是如何遍历的，如在遍历数组的时候，要了解数组需要通过索引来遍历

2. 遍历顺序并不是数据结构所固有的：一般情况下只能通过索引的递增或者递减这种方式只适合使用数组这样的数据结构，并不适合那些具有隐式顺序的数据结构

虽然ES中增加了Array.prototype.forEach()方法，这个方法虽然相较于循环遍历数据结构有了进步，但是这个方法不能标识什么时候终止迭代，所以这个方法也是有些缺憾。

虽然正常的流程不能终止foreach循环，但是可以通过曲线、迂回的方式终止掉，可以参考：[终止foreach循环](foreach.md)

在ECMAScript实现的语言中，虽然可以通过一些方式实现迭代虽然通过一些辅助的技术手段可以实现，但是随着代码量的增加，代码就会变的越来越臃肿且不易维护。在其他的语言中如java、python等通过语言结构从原生上解决了这个问题，开发者事先不用先了解数据结构的迭代模式就可以实现迭代的操作，这就是迭代器模式。Javascript从ECMAScript6版本开始也支持了迭代器模式。

### 迭代器模式

**迭代器模式**描述了一个方案，即可以把有些结构成为可迭代对象(iterable)，因为他们实现了正式的Iterable接口，而且可以通过迭代器Iterator消费(sonsume)。

可迭代对象，是一种抽象的说法。基本上可以把数组或者集合这样的类似集合类型的对象，它们包含的元素的个数都是有限的，而且具有无歧义的遍历顺序。

**可迭代对象**

1. 可迭代对象元素的个数是有限的；

### 可迭代对象和集合的关系

1. 可迭代对象不一定是集合对象：也可以是仅仅有类似数组行为的其他类型的数据结构，如下面的计数循环

```javascript
for (let i = 0; i < 10; i++) {
    console.log(i);
}
```

循环中产生的值是临时性的，但是循环本身就是在进行迭代；

> 计数循环和数组、集合都具有可迭代对象的行为

> 计数循环(临时性可迭代对象)可实现为生成器：Generator

任何实现Iterable接口的数据结构都可以被实现Iterator接口的结构“消费”(consume)。**迭代器(iterator)** 是按需创建的一次性对象。每个迭代器都会关联一个**可迭代对象**，而迭代器会暴露迭代其关联的可迭代对象的API。迭代器无需了解其关联的可迭代对象的结构，只需要知道如何取得连续的值。这种概念上的分离是Iterable和Iterator的强大之处。


### 可迭代协议

实现iterable接口(可迭代协议)要求同时具备两种能力：支持迭代的自我识别能力和创建实现Iterator接口对象的能力。